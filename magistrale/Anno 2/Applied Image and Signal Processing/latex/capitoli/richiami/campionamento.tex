%% TODO: C'Ã¨ una sezione nelle dispense di Vinti riguardante
%% la storia del campionamento. Non so se metterla ðŸ¤”

\section{Teorema del Campionamento}

\TODO[inline]{Completare questa parte !!}

Diamo la definizione del classico \textit{WKS-sampling theorem} o
\textit{Teorema del Campionamento}. Definiamo prima il \textbf{supporto}
di una funzione $f$ come:

$$
    \text{supp } f = \{ x \in \mathbb{R} : f(x) \neq 0 \}.
$$

%% TODO: qui ci stanno alcune discrepanze tra Vinti e Fagiolo, va ricontrollato.
\begin{theorem}
    Sia $f \in L^2(\mathbb{R}) \cap C(\mathbb{R})$ una funzione continua, ad energia finita e
    a banda limitata, i.e., tale che
    $\text{supp } \hat{f} \subset \left[ -\pi W, \ \pi W\right], W > 0$.
    Allora vale la seguente formula di interpolazione.

    $$
        f(t) = \sum_{k = - \infty}^{+\infty} f \left(\frac{k}{W}\right) sinc \left[ \pi(Wt - k) \right], \text{ con } t \in \mathbb{R}
    $$

    dove:

    $$
        sinc(t) :=
        \left\{ \begin{array}{cl}
            \frac{sin(\pi t)}{\pi t} & \ t \neq 0 \\
            1                        & \ t = 0
        \end{array} \right.
    $$
\end{theorem}


\begin{figure}[H]
    \centering
\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
    %uncomment if require: \path (0,300); %set diagram left start at 0, and has height of 300

    %Shape: Axis 2D [id:dp6614397845308091] 
    \draw  (204,183.5) -- (379,183.5)(291,82) -- (291,196.5) (372,178.5) -- (379,183.5) -- (372,188.5) (286,89) -- (291,82) -- (296,89)  ;
    %Straight Lines [id:da7696580538613964] 
    \draw    (250,161.25) -- (250,183.25) ;
    %Straight Lines [id:da059819649685002974] 
    \draw    (331,161.25) -- (331,183.25) ;
    %Straight Lines [id:da32947787237217474] 
    \draw    (331,161.25) -- (250,161.25) ;

    % Text Node
    \draw (222.5,191.5) node [anchor=north west][inner sep=0.75pt]   [align=left] {$\displaystyle -\pi W$};
    % Text Node
    \draw (316,192) node [anchor=north west][inner sep=0.75pt]   [align=left] {$\displaystyle \pi W$};
\end{tikzpicture}
    \caption{Una funzione a banda limitata}
\end{figure}

\begin{figure}[H]
    \centering
\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
    %uncomment if require: \path (0,300); %set diagram left start at 0, and has height of 300

    %Shape: Axis 2D [id:dp6614397845308091] 
    \draw  (204,230.75) -- (542.5,230.75)(306,82) -- (306,250.25) (535.5,225.75) -- (542.5,230.75) -- (535.5,235.75) (301,89) -- (306,82) -- (311,89)  ;
    %Straight Lines [id:da059819649685002974] 
    \draw    (421,226.75) -- (421,237.25) ;
    %Straight Lines [id:da333995992515034] 
    \draw    (441,226.75) -- (441,237.25) ;
    %Straight Lines [id:da4908605908983048] 
    \draw    (461,226.75) -- (461,237.25) ;
    %Straight Lines [id:da5180908391730039] 
    \draw    (400,226.75) -- (400,237.25) ;
    %Curve Lines [id:da6657246696267412] 
    \draw    (254,118.5) .. controls (269.59,106.81) and (338.93,97.87) .. (337.5,120.75) .. controls (336.07,143.63) and (365.6,210.17) .. (385,212.25) .. controls (404.4,214.33) and (425,145.75) .. (443,135.25) .. controls (461,124.75) and (493.73,190.83) .. (506.5,181.25) ;
    %Shape: Circle [id:dp878091919683829] 
    \draw  [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ][fill={rgb, 255:red, 208; green, 2; blue, 27 }  ,fill opacity=1 ] (397,202) .. controls (397,200.62) and (398.12,199.5) .. (399.5,199.5) .. controls (400.88,199.5) and (402,200.62) .. (402,202) .. controls (402,203.38) and (400.88,204.5) .. (399.5,204.5) .. controls (398.12,204.5) and (397,203.38) .. (397,202) -- cycle ;
    %Shape: Circle [id:dp017384754588354534] 
    \draw  [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ][fill={rgb, 255:red, 208; green, 2; blue, 27 }  ,fill opacity=1 ] (417,169.5) .. controls (417,168.12) and (418.12,167) .. (419.5,167) .. controls (420.88,167) and (422,168.12) .. (422,169.5) .. controls (422,170.88) and (420.88,172) .. (419.5,172) .. controls (418.12,172) and (417,170.88) .. (417,169.5) -- cycle ;
    %Shape: Circle [id:dp3580711979696489] 
    \draw  [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ][fill={rgb, 255:red, 208; green, 2; blue, 27 }  ,fill opacity=1 ] (436,139.5) .. controls (436,138.12) and (437.12,137) .. (438.5,137) .. controls (439.88,137) and (441,138.12) .. (441,139.5) .. controls (441,140.88) and (439.88,142) .. (438.5,142) .. controls (437.12,142) and (436,140.88) .. (436,139.5) -- cycle ;
    %Shape: Circle [id:dp2482434926915713] 
    \draw  [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ][fill={rgb, 255:red, 208; green, 2; blue, 27 }  ,fill opacity=1 ] (458,141.5) .. controls (458,140.12) and (459.12,139) .. (460.5,139) .. controls (461.88,139) and (463,140.12) .. (463,141.5) .. controls (463,142.88) and (461.88,144) .. (460.5,144) .. controls (459.12,144) and (458,142.88) .. (458,141.5) -- cycle ;

    % Text Node
    \draw (412.5,243) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left] {$\displaystyle \frac{k}{W}$};
    % Text Node
    \draw (435,243) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left] {$\displaystyle \frac{k}{W}$};
\end{tikzpicture}
    \caption{Esempio di applicazione del campionamento}
\end{figure}

In altre parole, il teorema del campionamento ci dice che, da una famiglia discreta di
valori campione, assunti in modo uniformemente spaziato su tutto lâ€™asse reale, Ã¨ possibile
ricostruire in modo esatto, un segnale ad energia finita (ovvero in $L^2(\mathbb{R})$) e a
banda limitata, mediante la serie interpolante introdotta sopra.


$\Delta t = 1/W$ denota lâ€™\textit{intervallo temporale} tra i campioni, $\pi W/ 2\pi = w/2$ denota
lâ€™\textit{ampiezza di banda} di $f$, che e misurata in cicli per unita di tempo (Hertz) e
$R = 1 /\Delta t$ denota lâ€™\textit{ordine di campionamento} (\textit{sampling rate}),
misurato in campioni per unita di tempo. 

H. Nyquist mise in rilievo il significato dellâ€™â€œintervalloâ€(numero) $1/W$ nella telegrafia
e Shannon lo chiamo \textit{intervallo di Nyquist} corrispondente alla frequenza di
banda $[âˆ’\pi W, \pi W]$. Lâ€™ordine di campionamento $R$, legato allâ€™intervallo di Nyquist,
rappresenta un minimo teorico per la ricostruzione del segnale.
Per essere piÃ¹ precisi, il teorema sampling costituisce un algoritmo che permette di
rispondere alle due seguenti domande:

\begin{enumerate}
    \item \textit{Quanti campioni sono necessari per assicurare che lâ€™informazione
        contenuta nel segnale venga preservata, durante il processo di ricostruzione?}\\

        Se il segnale contiene componenti di alte frequenze, Ã¨ necessario campionarlo almeno
        due volte la massima frequenza del segnale per evitare perdite di informazione,
        cioe $f_s \ge 2 f_H$ , dove $f_s$ e la frequenza sampling, $f_H$ e la piu alta
        frequenza del segnale e $f_s = 2 f_H$ Ã¨ la frequenza (ordine) di Nyquist.
        Campionare ad un ordine piÃ¹ alto di $2 f_H$ significa utilizzare una successione
        piÃ¹ fine di valori campione, e questo Ã¨ il caso del cosiddetto sovracampionamento (oversampling).
        Nella pratica il sovracampionamento deve essere effettuato molto spesso, poichÃ¨
        un fattore correttivo deve essere introdotto per compensare il fatto che il
        campionamento e lâ€™interpolazione non possono coincidere con i corrispondenti valori
        teorici; questo Ã¨ il caso del cosiddetto \textit{round-off error} o \textit{errore di
        quantizzazione}. Inoltre un altro errore temporale si presenta quando i campioni
        non possono essere presi esattamente agli istanti temporali $k/W$; questo errore Ã¨
        chiamato \textit{time-jitter error}.
        Un esempio concreto di sovracampionamento Ã¨ rappresentato dal un lettore di compact disk.
        Infatti considerando che la piu alta frequenza
        udibile Ã¨ approssimativamente intorno a 18.000 cicli al secondo (Hertz),
        a seconda dellâ€™ascoltatore, in base alla teoria precedente un segnale audio
        deve essere campionato almeno 36.000 volte al secondo per far sÃ¬ che
        il segnale venga ricostruito completamente. Lâ€™ordine di campionamento
        dei primi lettori di compact disk era di circa 44.000 campioni al secondo.
        Altre volte capita di non avere a disposizione un numero ragionevole di valori
        campione per ricostruire il segnale completamente. Questo
        avviene quando non conosciamo il segnale originale, ma dobbiamo ricostruirlo dalle
        informazioni che abbiamo a disposizione del segnale (cioÃ¨
        dai suoi valori campione). In questo caso, cioÃ¨ quando il numero di
        informazioni (valori campione) Ã¨ scarso, la distanza tra i nodi Ã¨ piÃ¹
        grande dellâ€™intervallo di Nyquist ed abbiamo il cosiddetto sottocampionamento
        (undersampling). In questo caso si presenta il fenomeno di
        aliasing e sostanzialmente cio che succede Ã¨ che le replicanti spettrali si
        sovrappongono.
    \item \textit{Dato un segnale, campionato ad un certo fissato ordine di campionamento,
        quali frequenze non devono essere contenute nel segnale al fine di preservare
        lâ€™informazione?}\\

        Questa Ã¨ la situazione inversa rispetto a quella presentata nella prima
        domanda. La risposta Ã¨ che un segnale campionato ad un fissato ordine
        di campionamento non puÃ² contenere componenti a frequenze superiori
        alla metÃ  dellâ€™ordine di campionamento, cioe: $f_H \leq f_s/2$, dove
        $f_H$ Ã¨ la frequenza piÃ¹ alta contenuta nel segnale e $f_s$ Ã¨ la frequenza
        sampling. In altre parole, la piÃ¹ alta frequenza che puo essere accuratamente
        rappresentata Ã¨ la metÃ  della frequenza sampling. Quindi il teorema
        sampling fornisce un limite superiore per la piÃ¹ alta frequenza $f_H$.
        Spieghiamolo con un esempio: supponiamo di utilizzare un CD-rom con un
        fissato ordine di campionamento di 44.1KHz. Nyquist afferma che la piÃ¹
        alta frequenza che puÃ² essere riprodotta da questo campionamento Ã¨ di
        22.05KHz. Infatti le frequenze superiori a 22.05KHz producono aliasing.
        Per evitare questo, puÃ² essere utilizzato un filtro passa basso per bloccare
        le frequenze superiori a 22.05KHz. Ãˆ importante notare che lâ€™aliasing
        puÃ² essere prodotto sia da segnali campionati non correttamente (con
        un numero di campioni non sufficiente) che da frequenze troppo alte del
        segnale aventi un fissato ordine di campionamento.
\end{enumerate}

\subsection{Svantaggi}

BenchÃ¨ il teorema del campionamento venga laramente impiegato in ambito applicativo
esso presenta svantaggi o limiti da questo punto di vista.

\begin{itemize}
    \item Le ipotesi fatte sul segnare da ricostruire $f$, ovvero che sia ad energia finita
        e a banda limitata, implicano che ci riduciamo a considerare una famiglia di segnali
        estremamente regolari e ci consente di ricostruire solo sengali appartenenti alla classe
        $C^{\infty}(\mathbb{R})$. Nelle applicazioni reali, i segnali difficilmente sono cosÃ¬
        regolari. Per esempio, nelle immagini, forti salti di livello nella scala di grigi
        (vedi bordi degli oggetti), matematicamente possono essere visti come delle 
        discontinuitÃ .
    \item Per ricostruire un segnale $f$ al tempo $t$ Ã¨ necessario un numero di campioni infinito
        e il loro valore viene rilevato sia all'istante precedente a $t$ che a quelli successivi.
        Dal punto di vista applicativo, una prima difficoltÃ  potrebbe essere quella di
        implementare una formula teorica che prevede infiniti termini.
        Il problema potrebbe essere risolto troncando la serie; tuttavia, questo introdurrebbe
        un errore (di troncamento) nella ricostruzione, che non garantirebbe piu
        lâ€™interpolazione del segnale ma una mera approssimazione.
        Inoltre, nei problemi reali, i segnali sono noti solo nel â€œpassatoâ€, ovvero i
        valori campione di $f$ sono noti, in generale, solo negli istanti di tempo $k/W$
        precedenti a $t$. I valori di $f(k/W)$ nel â€œfuturoâ€, ovvero quando $k/W > t$,
        non sono in generale disponibili.
    \item Per il principio di Hisemberg i segnali non possono essere contemporanemanete 
        a durata e banda limitata, quindi i segnali nel mondo reale, in generale, non soddisfano
        le ipotesi del teorema del campionamento.
\end{itemize}

